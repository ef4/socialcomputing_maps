<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no"/>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBZnvqy9HEpG-LAQwm_AxDOegMciI9jgP4&libraries=geometry&sensor=false"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <link rel="stylesheet" type="text/css" href="{{URL_PREFIX}}static/css/bootstrap.min.css"/>
    <link rel="stylesheet" type="text/css" href="{{URL_PREFIX}}static/css/tipsy.css"/> 
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css" rel="stylesheet">
    <link rel="stylesheet" href="//code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css">
    <script type="text/javascript" src="{{URL_PREFIX}}static/js/jquery.tipsy.js"></script>
    <script type="text/javascript" src="{{URL_PREFIX}}static/js/bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css" href="{{URL_PREFIX}}static/css/accidents.css"> </style>
    <script type="text/javascript" src="{{URL_PREFIX}}static/js/accidents_utils.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-47879752-1', 'mit.edu');
      ga('send', 'pageview');

    </script>


<script type="text/javascript">

var mapCenter = [-122.643914,45.515971];
var scaleFactor = 1.0;
var blurConstant = 0.3;
var clusterStrokeOpacity = 0.3;
var clusterStrokeWidth = 3;
var shellRandomShift = 0.002;
var shellOpacity = 0.2;
var coreOpacity = 0.5;
var cityName = 'Portland';
var URL_PREFIX = '{{URL_PREFIX}}';


$(window).load(function(){


  jQuery.getJSON('{{URL_PREFIX}}static/data/Portland/boundary.geojson', function(geojson){
    geoJSON = geojson;
    setProjection();
    drawMap();
    initialize();
    jQuery.getJSON('{{URL_PREFIX}}static/data/Portland/bicycle_accidents/final_data2.json', function(data){
      allData= data;
      accidentData = data['accidents'];
      finalClusters = allData['clusters'];
      processChartData(allData["streets"]);
      drawCircles();
      bindHoverHandlers();
    });
  });



});


</script>
</head>
<body>
  <img id="logo" src="{{URL_PREFIX}}static/img/logo.png">
  <div id="drawer">
      <svg height='50' width='50' style="z-index:1">
          <circle cx="25" cy="25" r="15" stroke-opacity="0.0" fill="#FA8602" fill-opacity="0.5" />
      </svg>
      <i id='button-icon' class="glyphicon glyphicon-chevron-left"></i>
  </div>

  <div id="infoGraphic">     
    <br></br>
    <br></br>
    <div id="tabContainer">
      <ul id="infoTabs" class="nav nav-tabs">
        <li id="tab_1" style="background-color:rgba(43, 40, 40, 0.7);"> Street Graph </li>
        <li id="tab_2"> Street View</li>
      </ul>
    </div>
    <div id="paneContent">
      <div id="tabcontent_1" >
        <br></br>
        <p align="center"> Accidents by Street </p>
        <p id="chartTitle" align="center"> </p>
        <div id="chart"> </div>
      </div>
      <div id="tabcontent_2">
        <br></br>
        <p id="address" align="left">Hover over an accident to explore.</p>
        <img id="street-view" > </img>
        <br></br>
      </div>
    </div>
  </div>
    
    <div id="svgContainer"></div>


    <p id='title'> Portland, OR</p>
    <!--<p id='years'> 2010 to 2013</p>
    <p id='numAccidents'> 1085 bicycle accidents </p>-->

    <div id='map-descp'>
      This map visualizes the 1085 bicycle accidents that were
      <br>
      reported in Portland between 2010 and 2013.
    </div>

    <div id='data-lightbox'>
      <div id='lightbox-close' class="glyphicon glyphicon-remove"></div>
      This map visualizes the 1085 bicycle accidents that were reported in Portland between 2010 and 2013.
      <br>
      00027, 00064, and 00283 had the most accidents during this time.  
      <br>
      The data was given to us by the <a href="http://www.oregon.gov/ODOT/TD/TDATA/Pages/index.aspx" class="footer-highlight-link"> Dept of Transportation, Oregon </a>
    </div>

    <div id="footer">
      <!--<img src="/static/img/logo.png" style="width: 40px;"/> -->
      This work is part of the <a href="http://youarehere.media.mit.edu">You Are Here</a> project
      <span class="footer-plus">+</span>
      <a href="http://socialcomputing.media.mit.edu"> The Social Computing Group </a>
      <span class="footer-plus">+</span>
      <a href="http://media.mit.edu"> MIT Media Lab </a>
      <span class="footer-plus">+</span>
      <a href="http://mit.edu"> MIT</a>
      &nbsp
      <span class="footer-plus">|</span>
      &nbsp
      <span id="data-source" class='footer-highlight'> Data Source</span>
    </div>
 
</body>
</html>